FROM jboss/keycloak:6.0.1
ADD ./target/sms-authenticator.jar /opt/jboss/keycloak/providers/sms-authenticator.jar
ADD ./themes/openstandia/login/sms-validation.ftl /opt/jboss/keycloak/themes/base/login/sms-validation.ftl 
ADD ./themes/openstandia/login/sms-validation-error.ftl /opt/jboss/keycloak/themes/base/login/sms-validation-error.ftl 
RUN echo 'backToLoginForm=Back to Login' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'verifySMSCodeTopMessage=Enter SMS code' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'sendSMSCodeErrorMessage="SMS could not be sent.' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'verifySMSCodeTopMessage=Enter SMS code' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'sendSMSCodeErrorMessage="SMS could not be sent."' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'invalidSMSCodeTopMessage="Code verification failure."' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties
RUN echo 'invalidSMSCodeMessage=badCode"' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties 
RUN echo 'missingTelNumberMessage=Missing mobile number"' >> /opt/jboss/keycloak/themes/base/login/messages/messages_en.properties  
USER root
RUN chown -R jboss:root /opt/jboss/keycloak/providers/ &&\
    chown -R jboss:root /opt/jboss/keycloak/themes/base/login/ &&\
    chmod +x /opt/jboss/keycloak/providers/sms-authenticator.jar
USER jboss
